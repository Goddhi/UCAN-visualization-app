services:
  - type: web
    name: ucan-visualizer-api
    runtime: go
    env: go
    region: oregon
    plan: free
    rootDir: apps/backend
    buildCommand: go build -o bin/server ./cmd/server
    startCommand: ./bin/server
    healthCheckPath: /health
    autoDeploy: true
    envVars:
      - key: PORT
        sync: false
      - key: HOST
        value: 0.0.0.0

  # --- New Frontend Service ---
  - type: web
      name: ucan-visualization-frontend
      runtime: node
      region: oregon
      plan: free
      buildCommand: yarn install --production=false && yarn build:frontend
      startCommand: cd apps/frontend && yarn start
      autoDeploy: true
      envVars:
        - key: NODE_VERSION
          value: 20.11.0
        - key: NODE_ENV
          value: production
        - key: NEXT_PUBLIC_API_URL
          value: https://ucan-visualizer-api.onrender.com 